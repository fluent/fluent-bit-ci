kind: Deployment
replicaCount: 1

rbac:
  create: false

image:
  repository: {{ image_repository }}
  pullPolicy: Always
  tag: {{ image_tag }}

extraVolumes:
  - name: gcs-credentials
    secret:
      secretName: google-service-account-sa-key

extraVolumeMounts:
  - name: gcs-credentials
    mountPath: /google_service_credentials.json
    subPath: google_service_credentials.json

config:
  service: |
    [SERVICE]
        Flush 5
        Daemon Off
        Log_Level debug
        HTTP_Server On
        HTTP_Listen 0.0.0.0
        HTTP_Port 2020
  inputs: |
    [INPUT]
        Name dummy
        Tag dummy.log
        Dummy {"message": "testing"}
        Rate 10
  outputs: |
    [OUTPUT]
        Name       bigquery
        Match      *
        dataset_id {{ bigquery_dataset_id }}
        table_id   {{ bigquery_table_id }}
        google_service_credentials /google_service_credentials.json
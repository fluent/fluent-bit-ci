kind: Deployment
replicaCount: 1

rbac:
  create: false
image:
  repository: {{ image_repository }}
  pullPolicy: Always
  tag: {{ image_tag }}

config:
  service: |
    [SERVICE]
        Flush 1
        Daemon Off
        Log_Level debug
        HTTP_Server On
        HTTP_Listen 0.0.0.0
        HTTP_Port 2020
  inputs: |
    [INPUT]
        Name dummy
        Tag rawoff
        Dummy {"message": "dummy", "raw": "off", "test_id": "{{ test_id }}"}
        Rate 1
    [INPUT]
        Name dummy
        Tag raw
        Dummy {"message": "dummy", "raw": "on", "nested": "off", "test_id": "{{ test_id }}"}
        Rate 1
    [INPUT]
        Name dummy
        Tag raw_nested
        Dummy {"message": "dummy", "raw": "on", "nested": "on", "test_id": "{{ test_id }}"}
        Rate 1
  filters: |
    [FILTER]
        Name nest
        Match raw_nested
        Operation nest
        Wildcard *
        Nest_Under event
  outputs: |
    [OUTPUT]
        Name        splunk
        Match       raw
        Host        splunk-master
        Port        8088
        Splunk_Send_Raw On
        TLS         On
        TLS.Verify  Off
        splunk_token fd27eae6-3951-4f84-95dd-3e450979305a
    [OUTPUT]
        Name        splunk
        Match       raw_nested
        Host        splunk-master
        Port        8088
        Splunk_Send_Raw On
        TLS         On
        TLS.Verify  Off
        splunk_token fd27eae6-3951-4f84-95dd-3e450979305a
    [OUTPUT]
        Name            splunk
        Match           rawoff
        Host            splunk-master
        Port            8088
        TLS             On
        TLS.Verify      Off
        splunk_token    fd27eae6-3951-4f84-95dd-3e450979305a
    [OUTPUT]
        Name exit
        Match *
